---
title: White plaque disease - Compilation of rawdata
author: Andia Chaves Fonnegra, Bernd Panassiti
date: '08.23.2016; last modified: `r format(Sys.Date(), format="%d.%m.%Y")`'
output: 
  pdf_document: 
    number_sections: yes
    toc: yes
header-includes: \usepackage{graphicx}
email: \email{}
---

```{r setup, include=FALSE, warnings=FALSE}
library(knitr)
opts_knit$set(root.dir='../')                     # definining working directory; or normalizePath('../')
opts_chunk$set(fig.align='center',                # aligns all figures
                echo=TRUE,                        # shows r-code
                message=FALSE,                    # suppresses library outputs
                warnings=FALSE,                   # suppresses library outputs
                tidy=TRUE,  # prevents the source code from running off a pdf page
                dev='pdf')                        # pdf device
```

# Introduction
Compilation of raw data. 


# Data

# Joint model
## Loading data 
```{r}
rm(list=ls(all=TRUE))
# Load settings
source('r-code/00_settings.R')


# load data & libraries
White <- read.csv("data/Rawdata_WP.csv", header = TRUE)
ls(White)
dim(White)
head(White)
```


Boxplots - figures
```{r}
library(ggplot2) 

#BOX-PLOTS PER MONTH ENVIRONMENTAL VARIABLES
#Chlorophyll
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p1 <- ggplot(White, aes(x = Month_12, y = Chlorophyll))+ scale_y_continuous(name = "Chlorophyll"~("mg m"^{-3})) + scale_x_discrete(name = "Months") +
      geom_boxplot()
p1


#Conductivity
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p2 <- ggplot(White, aes(x = Month_12, y = Conductivity)) +scale_y_continuous(name = "Conductivity"~("COS m"^{-1})) + scale_x_discrete(name = "Months") +
      geom_boxplot()
p2

#Density
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p3 <- ggplot(White, aes(x = Month_12, y = Density)) +scale_y_continuous(name = "Density"~("Kg"%*%"m"^{-3})) + scale_x_discrete(name = "Months") +
        geom_boxplot()
p3

#MAX DHW
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p4 <- ggplot(White, aes(x = Month_12, y = Max_DHW)) +  scale_y_continuous(name = "Max DHW") + scale_x_discrete(name = "Months") + geom_boxplot()
p4

#Oxygen
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p5 <- ggplot(White, aes(x = Month_12, y = Oxygen)) + scale_y_continuous(name = "Dissolved Oxygen"~("mg L"^{-1})) + scale_x_discrete(name = "Months") + 
     geom_boxplot()
p5

#Rainfall
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p6 <- ggplot(White, aes(x = Month_12, y = Rainfall)) + scale_y_continuous(name = "Rainfall (inches)") + scale_x_discrete(name = "Months") + 
geom_boxplot()
p6

#Salinity
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p7 <- ggplot(White, aes(x = Month_12, y = Salinity)) + scale_y_continuous(name = "Salinity (PSU)") + scale_x_discrete(name = "Months") + 
geom_boxplot()
p7

#Temperature
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p01 <- ggplot(White, aes(x = Month_12, y = Temperature)) + scale_y_continuous(name = "Temperature"~(degree*C)) + scale_x_discrete(name = "Months") + 
     geom_boxplot()
p01

#Turbidity
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p9 <- ggplot(White, aes(x = Month_12, y = Turbidity)) +  scale_y_continuous(name = "Turbidity (NTU)") + scale_x_discrete(name = "Months") + 
geom_boxplot()
p9

#WP prevalence
White$Month_12<-factor(White$Month_12)  #Convert Month into a labelled factor to use as a grouping variabel
p10 <- ggplot(White, aes(x = Month_12, y = White_Plague_Pervalence)) + scale_y_continuous(name = "WP Prevalence (diseased/total)") + scale_x_discrete(name = "Months") + geom_boxplot()
p10


```

BOX PLOTS ENVIRONMENTAL PER SEASON

```{r}
#BOX PLOTS ENVIRONMENTAL PER SEASON
#Chlorophyll
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p11 <- ggplot(White, aes(x = Season, y = Chlorophyll))+ scale_y_continuous(name = "Chlorophyll"~("mg m"^{-3})) + scale_x_discrete(name = "Seasons") +
      geom_boxplot()
p11


#Conductivity
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p12 <- ggplot(White, aes(x = Season, y = Conductivity)) +scale_y_continuous(name = "Conductivity"~("COS m"^{-1})) + scale_x_discrete(name = "Seasons") +
      geom_boxplot()
p12

#Density
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p13 <- ggplot(White, aes(x = Season, y = Density)) +scale_y_continuous(name = "Density"~("Kg"%*%"m"^{-3})) + scale_x_discrete(name = "Seasons") +
        geom_boxplot()
p13

#MAX DHW
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p14 <- ggplot(White, aes(x = Season, y = Max_DHW)) +  scale_y_continuous(name = "Max DHW") + scale_x_discrete(name = "Seasons") + geom_boxplot()
p14

#Oxygen
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p15 <- ggplot(White, aes(x = Season, y = Oxygen)) + scale_y_continuous(name = "Dissolved Oxygen"~("mg L"^{-1})) + scale_x_discrete(name = "Seasons") + 
     geom_boxplot()
p15

#Rainfall
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p16 <- ggplot(White, aes(x = Season, y = Rainfall)) + scale_y_continuous(name = "Rainfall (inches)") + scale_x_discrete(name = "Seasons") + 
geom_boxplot()
p16

#Salinity
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p17 <- ggplot(White, aes(x = Season, y = Salinity)) + scale_y_continuous(name = "Salinity (PSU)") + scale_x_discrete(name = "Seasons") + 
geom_boxplot()
p17

#Temperature
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p18 <- ggplot(White, aes(x = Season, y = Temperature)) + scale_y_continuous(name = "Temperature"~(degree*C)) + scale_x_discrete(name = "Seasons") + 
     geom_boxplot()
p18

#Turbidity
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p19 <- ggplot(White, aes(x = Season, y = Turbidity)) +  scale_y_continuous(name = "Turbidity (NTU)") + scale_x_discrete(name = "Seasons") + 
geom_boxplot()
p19

#WP prevalence
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p20 <- ggplot(White, aes(x = Season, y = White_Plague_Pervalence)) + scale_y_continuous(name = "WP Prevalence (diseased/total)") + scale_x_discrete(name = "Seasons") + geom_boxplot()
p20
```

BOX PLOTS ENVIRONMENTAL PER YEAR

```{r}
#Chlorophyll
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p21 <- ggplot(White, aes(x = Year, y = Chlorophyll))+ scale_y_continuous(name = "Chlorophyll"~("mg m"^{-3})) + scale_x_discrete(name = "Years") +
      geom_boxplot()
p21


#Conductivity
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p22 <- ggplot(White, aes(x = Year, y = Conductivity)) +scale_y_continuous(name = "Conductivity"~("COS m"^{-1})) + scale_x_discrete(name = "Years") +
      geom_boxplot()
p22

#Density
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p23 <- ggplot(White, aes(x = Year, y = Density)) +scale_y_continuous(name = "Density"~("Kg"%*%"m"^{-3})) + scale_x_discrete(name = "Years") +
        geom_boxplot()
p23

#MAX DHW
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p24 <- ggplot(White, aes(x = Year, y = Max_DHW)) +  scale_y_continuous(name = "Max DHW") + scale_x_discrete(name = "Years") + geom_boxplot()
p24

#Oxygen
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p25 <- ggplot(White, aes(x = Year, y = Oxygen)) + scale_y_continuous(name = "Dissolved Oxygen"~("mg L"^{-1})) + scale_x_discrete(name = "Years") + 
     geom_boxplot()
p25

#Rainfall
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p26 <- ggplot(White, aes(x = Year, y = Rainfall)) + scale_y_continuous(name = "Rainfall (inches)") + scale_x_discrete(name = "Years") + 
geom_boxplot()
p26

#Salinity
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p27 <- ggplot(White, aes(x = Year, y = Salinity)) + scale_y_continuous(name = "Salinity (PSU)") + scale_x_discrete(name = "Years") + geom_boxplot()
p27

#Temperature
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p28 <- ggplot(White, aes(x = Year, y = Temperature)) + scale_y_continuous(name = "Temperature"~(degree*C)) + scale_x_discrete(name = "Years") + 
     geom_boxplot()
p28

#Turbidity
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p29 <- ggplot(White, aes(x = Year, y = Turbidity)) +  scale_y_continuous(name = "Turbidity (NTU)") + scale_x_discrete(name = "Years") + 
geom_boxplot()
p29

#WP prevalence
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p30 <- ggplot(White, aes(x = Year, y = White_Plague_Pervalence)) + scale_y_continuous(name = "WP Prevalence (diseased/total)") + scale_x_discrete(name = "Years") + geom_boxplot()
p30
```

BOX PLOTS ENVIRONMENTAL PER DEPTH

```{r}
#Chlorophyll
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p31 <- ggplot(White, aes(x = Depth_disease_transect, y = Chlorophyll))+ scale_y_continuous(name = "Chlorophyll"~("mg m"^{-3})) + scale_x_discrete(name = "Depth (m)") +
      geom_boxplot()
p31


#Conductivity
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p32 <- ggplot(White, aes(x = Depth_disease_transect, y = Conductivity)) +scale_y_continuous(name = "Conductivity"~("COS m"^{-1})) + scale_x_discrete(name = "Depth (m)") +
      geom_boxplot()
p32

#Density
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p33 <- ggplot(White, aes(x = Depth_disease_transect, y = Density)) +scale_y_continuous(name = "Density"~("Kg"%*%"m"^{-3})) + scale_x_discrete(name = "Depth (m)") +
        geom_boxplot()
p33

#MAX DHW
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p34 <- ggplot(White, aes(x = Depth_disease_transect, y = Max_DHW)) +  scale_y_continuous(name = "Max DHW") + scale_x_discrete(name = "Depth (m)") + geom_boxplot()
p34

#Oxygen
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p35 <- ggplot(White, aes(x = Depth_disease_transect, y = Oxygen)) + scale_y_continuous(name = "Dissolved Oxygen"~("mg L"^{-1})) + scale_x_discrete(name = "Depth (m)") + 
     geom_boxplot()
p35

#Rainfall
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p36 <- ggplot(White, aes(x = Depth_disease_transect, y = Rainfall)) + scale_y_continuous(name = "Rainfall (inches)") + scale_x_discrete(name = "Depth (m)") + 
geom_boxplot()
p36

#Salinity
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p37 <- ggplot(White, aes(x = Depth_disease_transect, y = Salinity)) + scale_y_continuous(name = "Salinity (PSU)") + scale_x_discrete(name = "Depth (m)") + geom_boxplot()
p37

#Temperature
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p38 <- ggplot(White, aes(x = Depth_disease_transect, y = Temperature)) + scale_y_continuous(name = "Temperature"~(degree*C)) + scale_x_discrete(name = "Depth (m)") + 
     geom_boxplot()
p38

#Turbidity
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p39 <- ggplot(White, aes(x = Depth_disease_transect, y = Turbidity)) +  scale_y_continuous(name = "Turbidity (NTU)") + scale_x_discrete(name = "Depth (m)") + 
geom_boxplot()
p39

#WP prevalence
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p40 <- ggplot(White, aes(x = Depth_disease_transect, y = White_Plague_Pervalence)) + scale_y_continuous(name = "WP Prevalence (diseased/total)") + scale_x_discrete(name = "Depth (m)") + geom_boxplot()
p40
```

ENVIRONMENTAL PER REEF TYPE

```{r}
#Chlorophyll
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p41 <- ggplot(White, aes(x = Reef.Type, y = Chlorophyll))+ scale_y_continuous(name = "Chlorophyll"~("mg m"^{-3})) + scale_x_discrete(name = "Reef Type") +
      geom_boxplot()
p41


#Conductivity
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p42 <- ggplot(White, aes(x = Reef.Type, y = Conductivity)) +scale_y_continuous(name = "Conductivity"~("COS m"^{-1})) + scale_x_discrete(name = "Reef Type") +
      geom_boxplot()
p42

#Density
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p43 <- ggplot(White, aes(x = Reef.Type, y = Density)) +scale_y_continuous(name = "Density"~("Kg"%*%"m"^{-3})) + scale_x_discrete(name = "Reef Type") +
        geom_boxplot()
p43

#MAX DHW
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p44 <- ggplot(White, aes(x = Reef.Type, y = Max_DHW)) +  scale_y_continuous(name = "Max DHW") + scale_x_discrete(name = "Reef Type") + geom_boxplot()
p44

#Oxygen
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p45 <- ggplot(White, aes(x = Reef.Type, y = Oxygen)) + scale_y_continuous(name = "Dissolved Oxygen"~("mg L"^{-1})) + scale_x_discrete(name = "Reef type") + 
     geom_boxplot()
p45

#Rainfall
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p46 <- ggplot(White, aes(x = Reef.Type, y = Rainfall)) + scale_y_continuous(name = "Rainfall (inches)") + scale_x_discrete(name = "Reef Type") + 
geom_boxplot()
p46

#Salinity
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p47 <- ggplot(White, aes(x = Reef.Type, y = Salinity)) + scale_y_continuous(name = "Salinity (PSU)") + scale_x_discrete(name = "Reef Type") + geom_boxplot()
p47

#Temperature
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p48 <- ggplot(White, aes(x = Reef.Type, y = Temperature)) + scale_y_continuous(name = "Temperature"~(degree*C)) + scale_x_discrete(name = "Reef Type") + 
     geom_boxplot()
p48

#Turbidity
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p49 <- ggplot(White, aes(x = Reef.Type, y = Turbidity)) +  scale_y_continuous(name = "Turbidity (NTU)") + scale_x_discrete(name = "Reef Type") + 
geom_boxplot()
p49

#WP prevalence
White$Reef.Type<-factor(White$Reef.Type)  #Convert depth into a labelled factor to use as a grouping variabel
p50 <- ggplot(White, aes(x = Reef.Type, y = White_Plague_Pervalence)) + scale_y_continuous(name = "WP Prevalence (diseased/total)") + scale_x_discrete(name = "Reef Type") + geom_boxplot()
p50
```

BOX PLOTS BIOLOGICAL VARIABLES PER YEAR

```{r}
#% Orbicellids
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p51 <- ggplot(White, aes(x = Year, y = X.Orbicellids))+ scale_y_continuous(name = "% of Orbicellids") + scale_x_discrete(name = "Years") +
      geom_boxplot()
p51


#% Sand
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p52 <- ggplot(White, aes(x = Year, y = X.Sand)) +scale_y_continuous(name = "% of Sand") + scale_x_discrete(name = "Years") +
      geom_boxplot()
p52

#% Coral
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p53 <- ggplot(White, aes(x = Year, y = X.Coral)) +scale_y_continuous(name = "% of Coral") + scale_x_discrete(name = "Years") +
        geom_boxplot()
p53

#% Sponges
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p54 <- ggplot(White, aes(x = Year, y = X.Sponges)) +  scale_y_continuous(name = "% of Sponges") + scale_x_discrete(name = "Years") + geom_boxplot()
p54

#% Macroalgae
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p55 <- ggplot(White, aes(x = Year, y = X.Macroalgae)) + scale_y_continuous(name = "% of Macroalgae") + scale_x_discrete(name = "Years") + 
     geom_boxplot()
p55

#% of Cyanobacteria
White$Year<-factor(White$Year)  #Convert Month into a labelled factor to use as a grouping variabel
p56 <- ggplot(White, aes(x = Year, y = X.Cyanobacteria)) + scale_y_continuous(name = "% of Cyanobacteria") + scale_x_discrete(name = "Years") + 
geom_boxplot()
p56

```

BOX PLOTS BIOLOGICAL VARIABLES PER DEPTH

```{r}
#% Orbicellids
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p57 <- ggplot(White, aes(x = Depth_disease_transect, y = X.Orbicellids))+ scale_y_continuous(name = "% of Orbicellids") + scale_x_discrete(name = "Depth (m)") +
      geom_boxplot()
p57


#% Sand
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p58 <- ggplot(White, aes(x = Depth_disease_transect, y = X.Sand)) +scale_y_continuous(name = "% of Sand") + scale_x_discrete(name = "Depth (m)") +
      geom_boxplot()
p58

#% Coral
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p59 <- ggplot(White, aes(x = Depth_disease_transect, y = X.Coral)) +scale_y_continuous(name = "% of Coral") + scale_x_discrete(name = "Depth (m)") +
        geom_boxplot()
p59

#% Sponges
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p60 <- ggplot(White, aes(x = Depth_disease_transect, y = X.Sponges)) +  scale_y_continuous(name = "% of Sponges") + scale_x_discrete(name = "Depth (m)") + geom_boxplot()
p60

#% Macroalgae
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p61 <- ggplot(White, aes(x = Depth_disease_transect, y = X.Macroalgae)) + scale_y_continuous(name = "% of Macroalgae") + scale_x_discrete(name = "Depth (m)") + 
     geom_boxplot()
p61

#% of Cyanobacteria
White$Depth_disease_transect<-factor(White$Depth_disease_transect)  #Convert depth into a labelled factor to use as a grouping variabel
p62 <- ggplot(White, aes(x = Depth_disease_transect, y = X.Cyanobacteria)) + scale_y_continuous(name = "% of Cyanobacteria") + scale_x_discrete(name = "Depth (m)") + 
geom_boxplot()
p62
```

BOX PLOTS BIOLOGICAL VARIABLES PER TYPE OF REEF
```{r}

#% Orbicellids
White$Reef.Type<-factor(White$Reef.Type)  #Convert reef type into a labelled factor to use as a grouping variabel
p63 <- ggplot(White, aes(x = Reef.Type,  y = X.Orbicellids))+ scale_y_continuous(name = "% of Orbicellids") + scale_x_discrete(name = "Reef Type") +
      geom_boxplot()
p63

#% Sand
White$Reef.Type<-factor(White$Reef.Type)  #Convert reef type into a labelled factor to use as a grouping variabel
p64 <- ggplot(White, aes(x = Reef.Type, y = X.Sand)) +scale_y_continuous(name = "% of Sand") + scale_x_discrete(name = "Reef Type (m)") +
      geom_boxplot()
p64

#% Coral
White$Reef.Type<-factor(White$Reef.Type)  #Convert reef type into a labelled factor to use as a grouping variabel
p65 <- ggplot(White, aes(x = Reef.Type, y = X.Coral)) +scale_y_continuous(name = "% of Coral") + scale_x_discrete(name = "Reef Type") +
        geom_boxplot()
p65

#% Sponges
White$Reef.Type<-factor(White$Reef.Type)  #Convert reef type into a labelled factor to use as a grouping variabel
p66 <- ggplot(White, aes(x = Reef.Type, y = X.Sponges)) +  scale_y_continuous(name = "% of Sponges") + scale_x_discrete(name = "Reef Type") + geom_boxplot()
p66

#% Macroalgae
White$Reef.Type<-factor(White$Reef.Type)  #Convert reef type into a labelled factor to use as a grouping variabel
p64 <- ggplot(White, aes(x = Reef.Type, y = X.Macroalgae)) + scale_y_continuous(name = "% of Macroalgae") + scale_x_discrete(name = "Reef Type") + 
     geom_boxplot()
p64

#% of Cyanobacteria
White$Reef.Type<-factor(White$Reef.Type)  #Convert reef type into a labelled factor to use as a grouping variabel
p65 <- ggplot(White, aes(x = Reef.Type, y = X.Cyanobacteria)) + scale_y_continuous(name = "% of Cyanobacteria") + scale_x_discrete(name = "Reef Type") + 
geom_boxplot()
p65

```

BOXPLOTS BIOLOGICAL VARIABLES PER SEASON

```{r}
#BOX PLOTS BIOLOGICAL VARIABLESL PER SEASON
#% Orbicellids
White$Season<-factor(White$Season)  #Convert Month into a labelled factor to use as a grouping variabel
p66 <- ggplot(White, aes(x = Season, y = X.Orbicellids))+ scale_y_continuous(name = "% of Orbicellids") + scale_x_discrete(name = "Seasons") +
      geom_boxplot()
p66


#% Sand
White$Season<-factor(White$Season)  #Convert reef type into a labelled factor to use as a grouping variabel
p67 <- ggplot(White, aes(x = Season, y = X.Sand)) +scale_y_continuous(name = "% of Sand") + scale_x_discrete(name = "Seasons") +
      geom_boxplot()
p67

#% Coral
White$Season<-factor(White$Season)  #Convert reef type into a labelled factor to use as a grouping variabel
p68 <- ggplot(White, aes(x = Season, y = X.Coral)) +scale_y_continuous(name = "% of Coral") + scale_x_discrete(name = "Seasons") +
        geom_boxplot()
p68

#% Sponges
White$Season<-factor(White$Season)  #Convert reef type into a labelled factor to use as a grouping variabel
p69 <- ggplot(White, aes(x = Season, y = X.Sponges)) +  scale_y_continuous(name = "% of Sponges") + scale_x_discrete(name = "Seasons") + geom_boxplot()
p69

#% Macroalgae
White$Season<-factor(White$Season)  #Convert reef type into a labelled factor to use as a grouping variabel
p70 <- ggplot(White, aes(x = Season, y = X.Macroalgae)) + scale_y_continuous(name = "% of Macroalgae") + scale_x_discrete(name = "Seasons") + 
     geom_boxplot()
p70

#% of Cyanobacteria
White$Season<-factor(White$Season)#Convert reef type into a labelled factor to use as a grouping variabel
p71 <- ggplot(White, aes(x = Season, y = X.Cyanobacteria)) + scale_y_continuous(name = "% of Cyanobacteria") + scale_x_discrete(name = "Seasons") + 
geom_boxplot()
p71

```


Check data for correlations
```{r}
#Eliminate Month-text column, as we have a Monthnumber column
White.filtered$Month <- NULL

#Subset the data for environmental variables
Env1 <- data.frame(White.filtered[,4:9]) #Six Environmental variables at a time
Env2<- data.frame(White.filtered[,10:14]) # Four more environmental variables
Env3<- data.frame(White.filtered[c(4:6,10:14)]) #Three variables from Env1 and five from Env2
Env4<- data.frame(White.filtered[c(7:9,10:14)]) #Other three variables from Env1 and five from Env2

head(Env3)

#Exploring data summary
#summary(White.filtered)

#use ggpairs to check possible correlations between all 11 environmental variables

library(GGally)
ggpairs(Env1) # Fig Env1. correlated salinity with depth and density with depth
ggpairs(Env2) # Fig En2. No correlation rain and turbidity not clear correlated when using all the stations shallow and deep
ggpairs(Env3) #conductivity and temperature are correlated, and density and temperature

ggpairs(Env4)

#Correlated environmental variables include:


```

Loading libraries
```{r load Libraries if required}

if(!require(formatR))
{
  install.packages("formatR", repos = mir)
  require(formatR)
}

if(!require(StanHeaders)) 
{
  install.packages("StanHeaders", repos = mir)
  require(StanHeaders)
}

if(!require(rstan))
{
  install.packages("rstan", repos = mir)
  require(rstan)
}

if(!require(MCMCpack)) # rwish function
{
  install.packages("MCMCpack", repos = mir)
  require(MCMCpack)
}

if(!require(modeest)) 
{
  install.packages("modeest", repos = mir)
  require(modeest)
} 

if(!require(IDPmisc))
{
  install.packages("IDPmisc", repos = mir)
  require(IDPmisc)
} 

if(!require(ggplot2)) 
{
  install.packages("ggplot2", repos = mir)
  require(ggplot2)
}
if(!require(shinystan))
{
  install.packages("shinystan", repos = mir)
  require(shinystan)
}
if(!require(qtlcharts))
{
  install.packages("qtlcharts", repos = mir)
  require(qtlcharts)
}
```




Data preparation.All environmental data is scaled due to difference in units, this to avoid
adding more variability in the analysis
```{r data_preparation}

White$Chl_sca   <- scale(White$Chlorophyll)
White$Cond_sca    <- scale(White$Conductivity)
White$Den_sca    <- scale(White$Density)
White$DepCTD_sca    <- scale(White$Depth_CTD)
White$Oxy_sca   <- scale(White$Oxygen)
White$Sal_sca    <- scale(White$Salinity)
White$Turb_sca    <- scale(White$Turbidity)
White$Depth-tran_sca    <- scale(White$Depth_disease_transect)
White$Temp_sca    <- scale(White$Temperature)
White$DHW_sca    <- scale(White$Max_DHW)
White$Rain_sca    <- scale(White$Rainfall)


Year=White$Year
Month=White$Month_number
Season=White$Season
Station=White$Station_name
Depth=White$Depth_disease_transect

##Environmental variables include temperature and rainfall
enviroselection = c(10:20) # to select environmental variables
```


# Data as a list
```{r}
Season=c(sort(rep(1:4,4)))
dataList = list (
        TotalObservedcolonies = White$Ntot,
        Diseasedcolonies = White$ill,
        nWP = length(White$Plague),
        
        Cor = White$Cor,

        Environment = White[12:(12-1+length(enviroselection))], # Temp, Chlorophyll, Salinity, Turbidity
        nEnvi = length(enviroselection),

        Season = White$Season,
        Year = White$Year,
        Station = White$Station,
        nSeason = length(unique(Season)),
        nYear= length(unique(Year)),
        nStation = length(unique(Station))
        
)
```

